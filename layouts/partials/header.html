<header class="sticky top-0 z-20 backdrop-blur bg-base/80 border-b border-stroke">
  <div class="max-w-6xl mx-auto px-4 md:px-0 py-4 flex items-center gap-8">
    {{/* Hamburger button — mobile only, before logo */}}
    <button id="menu-toggle" class="md:hidden p-2 -ml-2 text-muted hover:text-text transition" aria-label="Toggle menu" aria-expanded="false" aria-controls="mobile-menu">
      <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line id="menu-line1" x1="3" y1="6" x2="21" y2="6" class="origin-center transition-all duration-200" />
        <line id="menu-line2" x1="3" y1="12" x2="21" y2="12" class="origin-center transition-all duration-200" />
        <line id="menu-line3" x1="3" y1="18" x2="21" y2="18" class="origin-center transition-all duration-200" />
      </svg>
    </button>

    <a href="{{ .Site.Home.RelPermalink }}" class="flex items-center gap-2 font-display text-lg font-semibold">
      <span class="flex items-center">
        <span class="text-accent font-semibold">crafted</span>
        <span>signal</span>
      </span>
    </a>

    <nav class="hidden md:flex gap-4 text-sm text-muted flex-wrap">
      <a href="/#how-it-works" class="hover:text-text transition">{{ i18n "navHowItWorks" | default "How it works" }}</a>
      <a href="/for/" class="hover:text-text transition">{{ i18n "navSolutions" | default "Solutions" }}</a>
      <a href="/#trust" class="hover:text-text transition">{{ i18n "navTrust" | default "Security" }}</a>
      <a href="/docs/" class="hover:text-text transition">{{ i18n "navDocs" | default "Documentation" }}</a>
    </nav>

    <div class="ml-auto flex items-center gap-3">
      <a class="inline-flex px-4 py-2 rounded-xl bg-accent text-white text-sm font-semibold shadow-soft hover:scale-[1.01] transition" href="https://app.craftedsignal.io/" target="_blank" rel="noopener noreferrer">{{ i18n "navLogin" | default "Login" }}</a>
      <a class="hidden sm:inline-flex px-4 py-2 rounded-xl border border-stroke text-sm font-semibold text-text hover:border-accent/60 transition" href="mailto:{{ .Site.Params.email }}">{{ i18n "navContact" | default "Contact" }}</a>
    </div>
  </div>

  {{/* Mobile menu panel */}}
  <nav id="mobile-menu" class="hidden md:hidden border-t border-stroke bg-base/95 backdrop-blur">
    <div class="max-w-6xl mx-auto px-4 py-4 flex flex-col gap-3 text-sm">
      <a href="/#how-it-works" class="py-2 text-muted hover:text-text transition">{{ i18n "navHowItWorks" | default "How it works" }}</a>
      <a href="/for/" class="py-2 text-muted hover:text-text transition">{{ i18n "navSolutions" | default "Solutions" }}</a>
      <a href="/#trust" class="py-2 text-muted hover:text-text transition">{{ i18n "navTrust" | default "Security" }}</a>
      <a href="/docs/" class="py-2 text-muted hover:text-text transition">{{ i18n "navDocs" | default "Documentation" }}</a>
      <a href="mailto:{{ .Site.Params.email }}" class="py-2 text-muted hover:text-text transition">{{ i18n "navContact" | default "Contact" }}</a>
    </div>
  </nav>
</header>

<script>
(function () {
  const btn = document.getElementById('menu-toggle');
  const menu = document.getElementById('mobile-menu');
  const l1 = document.getElementById('menu-line1');
  const l2 = document.getElementById('menu-line2');
  const l3 = document.getElementById('menu-line3');

  function toggle(open) {
    const isOpen = typeof open === 'boolean' ? open : menu.classList.contains('hidden');
    menu.classList.toggle('hidden', !isOpen);
    btn.setAttribute('aria-expanded', isOpen);
    // Animate hamburger → X
    if (isOpen) {
      l1.setAttribute('y1', '12'); l1.setAttribute('y2', '12');
      l1.style.transform = 'rotate(45deg)';
      l2.style.opacity = '0';
      l3.setAttribute('y1', '12'); l3.setAttribute('y2', '12');
      l3.style.transform = 'rotate(-45deg)';
    } else {
      l1.setAttribute('y1', '6'); l1.setAttribute('y2', '6');
      l1.style.transform = '';
      l2.style.opacity = '';
      l3.setAttribute('y1', '18'); l3.setAttribute('y2', '18');
      l3.style.transform = '';
    }
  }

  btn.addEventListener('click', function () { toggle(); });

  menu.querySelectorAll('a').forEach(function (link) {
    link.addEventListener('click', function () { toggle(false); });
  });

  document.addEventListener('keydown', function (e) {
    if (e.key === 'Escape' && !menu.classList.contains('hidden')) toggle(false);
  });
})();
</script>
